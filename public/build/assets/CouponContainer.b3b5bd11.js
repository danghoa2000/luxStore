import{a7 as W,u as J,r as l,R as e,G as S,C as k,F as O,h as g,a8 as C,a9 as T,B as R,c as G,T as z,aa as Q,ab as X,ac as Z,S as ee,o as te,d as U,b7 as ae,q as N}from"./index.5ce80200.js";import{T as re,a as se,E as ne,b as oe,c as ce,d as M,e as le}from"./EnhancedTableHead.4e137c38.js";import{a as ie,R as me}from"./pathUrl.54e42181.js";import{T as j}from"./TextField.f7bb6de6.js";import{S as q}from"./Select.fa04d544.js";import{B as ue}from"./Breadcrumbs.f5b119d2.js";import{S as de}from"./Search.7dacac20.js";import{A as pe}from"./AddCircleSharp.04bafc2d.js";import{C as Ee,R as ge}from"./ReportProblem.91ad1bc7.js";import{B as ye}from"./BorderColor.6ee4679d.js";import{f as V}from"./index.d7c082dd.js";import{p as D}from"./index.ac026f14.js";import"./KeyboardArrowRight.e41f0be0.js";import"./LastPage.e4998160.js";import"./OutlinedInput.63c5b1ce.js";const be=o=>{const{headCells:a,setSearchFiled:v,groupCategoryList:y}=o,[s]=W(),{handleSubmit:h,control:i,reset:P,setValue:p,getValues:x}=J({defaultValues:{coupon_code:"",date_start:"",date_finish:""}}),E=l.exports.useMemo(()=>{const m=[];return Object.keys(a).forEach((t,d)=>{a[t].id!=="province_id"&&a[t].id!=="district_id"&&a[t].id!=="commune_id"&&a[t].id!=="status"&&a[t].id!=="qty"&&a[t].id!=="value"&&(a[t].type==="date"?m.push(e.createElement(S,{item:!0,xs:4,key:d},e.createElement(k,{name:a[t].id,control:i,render:({field:n})=>e.createElement(O,{variant:"standard"},e.createElement(j,{...n,label:s(a[t].label),type:"date",size:"small",InputLabelProps:{shrink:!0},onBlur:c=>{p(a[t].id,c.target.value?c.target.value.trim():"")}}))}))):a[t].id==="role"?m.push(e.createElement(S,{item:!0,xs:4,key:d},e.createElement(k,{name:a[t].id,control:i,render:({field:n})=>e.createElement(O,{variant:"standard"},e.createElement(q,{...n,label:s(a[t].label),size:"small"},e.createElement(g,{value:-1},"select option"),e.createElement(g,{value:C.EMPLOYEE},s(`role.${C.EMPLOYEE}`)),e.createElement(g,{value:C.MANAGER},s(`role.${C.MANAGER}`))))}))):a[t].id==="status"?m.push(e.createElement(S,{item:!0,xs:4,key:d},e.createElement(k,{name:a[t].id,control:i,render:({field:n})=>e.createElement(O,{variant:"standard"},e.createElement(q,{...n,label:s(a[t].label),size:"small"},e.createElement(g,{key:"",value:-1},"select option"),e.createElement(g,{key:T.ACTIVE,value:T.ACTIVE},s(`status.${T.ACTIVE}`)),e.createElement(g,{key:T.BLOCK,value:T.BLOCK},s(`status.${T.BLOCK}`))))}))):a[t].id==="group_category_id"?m.push(e.createElement(S,{item:!0,xs:4,key:d},e.createElement(k,{name:a[t].id,control:i,render:({field:n})=>e.createElement(O,{variant:"standard"},e.createElement(q,{...n,label:s("category.list.table.group_category_id"),size:"small"},e.createElement(g,{key:"",value:-1},"select group category"),y.length>0&&y.map(c=>e.createElement(g,{key:c.id,value:c.id},c.name))))}))):m.push(e.createElement(S,{item:!0,xs:4,key:d},e.createElement(k,{name:a[t].id,control:i,render:({field:n})=>e.createElement(O,{variant:"standard"},e.createElement(j,{...n,label:s(a[t].label),size:"small",onBlur:c=>{p(a[t].id,c.target.value?c.target.value.trim():"")},style:{textTransform:a[t].id=="coupon_code"?"uppercase":"unset"}}))}))))}),m},[y]),u=m=>{v(m)};return e.createElement("div",null,e.createElement("form",{onSubmit:h(u)},e.createElement(S,{container:!0,sx:{margin:0,padding:1,width:"100%"},spacing:10},E,e.createElement("div",{className:"d-flex w-100"},e.createElement(R,{variant:"contained",type:"submit",className:"m-1",style:{background:"#28a745"}},"Search"),e.createElement(R,{variant:"contained",type:"reset",className:"m-1 btn-cancel",onClick:()=>{P(),v({})}},"Clear")))))},fe=o=>{const{open:a,setOpen:v,order:y,orderBy:s,page:h,rowsPerPage:i,handleRequestSort:P,handleChangePage:p,handleChangeRowsPerPage:x,redirectCouponCreate:E,headCells:u,couponList:m,showNoti:t,status:d,setShowNoti:n,setSearchFiled:c,totalRecord:L,deleteCoupon:A}=o,B=G();return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex justify-content-between align-items-center"},e.createElement(z,{variant:"h4",gutterBottom:!0},"Coupon"),e.createElement(ue,{separator:"\u203A","aria-label":"breadcrumb"},e.createElement(Q,{to:"/admin"},"Home"),e.createElement(z,null,"Coupon"))),e.createElement("div",{style:{marginBottom:10}},e.createElement(R,{variant:"contained",onClick:()=>v(!a)},"Filter ",e.createElement(de,{sx:{marginLeft:1}})),e.createElement(R,{variant:"contained",onClick:()=>E(),sx:{marginLeft:2}},"Create ",e.createElement(pe,{sx:{marginLeft:1}}))),e.createElement(Ee,{in:a,timeout:"auto",unmountOnExit:!0},e.createElement("div",{className:"card__admin"},e.createElement(be,{headCells:u,setSearchFiled:c}))),e.createElement("div",{className:"card__admin"},e.createElement(X,{style:{margin:"-25px"}},e.createElement(re,{sx:{maxHeight:600},className:"table__dark"},e.createElement(se,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"medium",stickyHeader:!0,"aria-label":"sticky table"},e.createElement(ne,{order:y,orderBy:s,onRequestSort:P,headCells:u}),e.createElement(oe,null,m.length>0?m.map((b,F)=>e.createElement(ce,{hover:!0,key:F},e.createElement(M,{component:"td",scope:"row",padding:"normal"},e.createElement(ye,{color:"primary",className:"action",onClick:()=>{B(ie.UPDATE,{state:{id:b.id}})}}),e.createElement("span",{className:"tool"}),e.createElement(me,{color:"error",className:"action",onClick:()=>A(b.id)})),Object.keys(u).map((f,w)=>e.createElement(M,{component:"td",key:w,scope:"row",padding:"normal"},u[f].render?u[f].convert?Z(u[f].render(b)):u[f].render(b):b[f])))):e.createElement(M,{align:"center",colSpan:Object.keys(u).length+1,style:{opacity:.5,height:"100px"}},e.createElement(ge,null)," No data")))),e.createElement(le,{rowsPerPageOptions:[5,10,25],component:"div",className:"paginate__admin",count:L,rowsPerPage:i,page:h,onPageChange:p,onRowsPerPageChange:x}))),t&&e.createElement(ee,{type:d.type,message:d.message,setShowNoti:n}))},_e={coupon_code:{id:"coupon_code",numeric:!1,label:"coupon.list.table.coupon_code",type:"text"},status:{id:"status",numeric:!0,label:"coupon.list.table.status",convert:!0,render:o=>`status.${o.status}`,type:"status"},date_start:{id:"date_start",numeric:!0,label:"coupon.list.table.date_start",render:o=>o.date_start?V(D(o.date_start),"yyyy-MM-dd"):"",type:"date"},date_finish:{id:"date_finish",numeric:!0,label:"coupon.list.table.date_finish",render:o=>o.date_finish?V(D(o.date_finish),"yyyy-MM-dd"):"",type:"date"},value:{id:"value",numeric:!0,label:"coupon.list.table.price_discount",render:o=>te(o.value||0)},qty:{id:"qty",numeric:!0,label:"coupon.list.table.qty"}},we=()=>{const[o,a]=l.exports.useState([]),[v,y]=l.exports.useState(!0),[s,h]=l.exports.useState("asc"),[i,P]=l.exports.useState("coupon_code"),[p,x]=l.exports.useState(0),[E,u]=l.exports.useState(5),[m,t]=l.exports.useState({}),[d,n]=l.exports.useState(!1),[c,L]=l.exports.useState({}),[A,B]=l.exports.useState(0),b=G(),F={..._e},f=(_,r)=>{h(i===r&&s==="asc"?"desc":"asc"),P(r)},w=(_,r)=>{x(r)},K=_=>{u(parseInt(_.target.value,10)),x(0)},$=l.exports.useCallback(()=>{b("/admin/coupon/create")},[]),H=l.exports.useCallback(()=>{const _={searchField:c,pageSize:E,currentPage:p,currentSort:i,currentDirection:s};U.get(ae.LIST,{params:{..._}}).then(r=>{r.data.code===N.HTTP_OK&&(a(r.data.coupons),B(r.data.total))}).catch(r=>{t({type:"error",message:r.data?r.data.message:"Server error"}),n(!0)})},[s,i,p,E,c]);l.exports.useEffect(()=>{H()},[s,i,p,E,c]);const Y=l.exports.useCallback(_=>{U.delete(CATEGORIES_API.DELETE+"/"+_).then(r=>{r.data.code===N.HTTP_OK&&(t({type:"success",message:r.data.message}),n(!0),H()),r.data.code===N.HTTP_NOT_FOUND&&(n(!0),t({type:"error",message:r.data.message}))}).catch(({response:r})=>{r.data.code===N.UNPROCESSABLE_ENTITY&&Object.keys(r.data.errors).forEach(I=>{setError(I,{type:"custom",message:Object.values(r.data.errors[I])})}),t({type:"error",message:r.data?r.data.message:"Server error"}),n(!0)})},[]);return e.createElement(fe,{open:v,setOpen:y,order:s,orderBy:i,page:p,rowsPerPage:E,handleRequestSort:f,handleChangePage:w,handleChangeRowsPerPage:K,redirectCouponCreate:$,headCells:F,couponList:o,showNoti:d,status:m,setShowNoti:n,setSearchFiled:L,totalRecord:A,deleteCoupon:Y})};export{we as default};
