import{a7 as D,R as e,T as q,aa as U,B as T,G as d,C as g,F as h,N as B,O,ar as k,as as W,at as Y,i as $,S as z,c as J,r as u,ay as X,au as Z,av as f,d as w,b7 as A,q as v,u as ee,a9 as te,aw as ae}from"./index.5ce80200.js";import{B as re}from"./Breadcrumbs.f5b119d2.js";import{B as P}from"./BorderColor.6ee4679d.js";import{T as I}from"./TextField.f7bb6de6.js";import{R as se,F as L,a as V}from"./RadioGroup.7a04bd2c.js";import{f as H}from"./index.d7c082dd.js";import{p as R}from"./index.ac026f14.js";import"./Select.fa04d544.js";import"./OutlinedInput.63c5b1ce.js";const ne=y=>{const{redirectBack:x,handleUpdate:_,handleSubmit:N,control:a,reset:S,setValue:o,getValues:t,errors:l,loading:E,showNoti:p,status:b,setShowNoti:C}=y,[r]=D();return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex justify-content-between align-items-center"},e.createElement(q,{variant:"h4",gutterBottom:!0},"Coupon"),e.createElement(re,{separator:"\u203A","aria-label":"breadcrumb"},e.createElement(U,{to:"/admin"},"Home"),e.createElement(U,{to:"/admin/categories"},"Coupon"),e.createElement(q,null,"Update"))),e.createElement("div",{style:{marginBottom:10}},e.createElement(T,{variant:"contained",onClick:()=>x()},"Back")),e.createElement("form",{onSubmit:N(_)},e.createElement("div",{className:"card__admin"},e.createElement(d,{container:!0,sx:{margin:0,padding:1,width:"100%"},spacing:10},e.createElement(d,{item:!0,xs:6},e.createElement(g,{name:"coupon_code",control:a,render:({field:s})=>e.createElement(h,{variant:"standard"},e.createElement(B,{htmlFor:""},r("coupon.list.table.coupon_code"),e.createElement("span",{className:"required"})),e.createElement(O,{...s,startAdornment:e.createElement(k,{position:"start"},e.createElement(W,null)),placeholder:r("placehoder",{name:r("coupon.list.table.coupon_code")}),onBlur:n=>{o(n.target.id,n.target.value?n.target.value.trim():"")}}))}),l.coupon_code&&e.createElement("p",{className:"text-danger"},l.coupon_code.message)),e.createElement(d,{item:!0,xs:6}),e.createElement(d,{item:!0,xs:6},e.createElement(g,{name:"date_start",control:a,render:({field:s})=>e.createElement(h,{variant:"standard"},e.createElement(B,{htmlFor:"date_start"},r("coupon.list.table.date_start")),e.createElement(O,{id:"date_start",...s,startAdornment:e.createElement(k,{position:"start"},e.createElement(P,null)),placeholder:r("placehoder",{name:r("coupon.list.table.date_start")}),onBlur:n=>{o(n.target.id,n.target.value?n.target.value.trim():"")},type:"date"}))}),l.date_start&&e.createElement("p",{className:"text-danger"},l.date_start.message)),e.createElement(d,{item:!0,xs:6},e.createElement(g,{name:"date_finish",control:a,render:({field:s})=>e.createElement(h,{variant:"standard"},e.createElement(B,{htmlFor:"date_finish"},r("coupon.list.table.date_finish")),e.createElement(O,{id:"date_finish",...s,startAdornment:e.createElement(k,{position:"start"},e.createElement(P,null)),placeholder:r("placehoder",{name:r("coupon.list.table.date_finish")}),onBlur:n=>{o(n.target.id,n.target.value?n.target.value.trim():"")},type:"date"}))}),l.date_finish&&e.createElement("p",{className:"text-danger"},l.date_finish.message)),e.createElement(d,{item:!0,xs:6},e.createElement(g,{name:"value",control:a,render:({field:s})=>e.createElement(h,{variant:"standard"},e.createElement(I,{...s,label:r("coupon.list.table.price_discount"),type:"number",variant:"standard"}))}),l.value&&e.createElement("p",{className:"text-danger"},l.value.message)),e.createElement(d,{item:!0,xs:6},e.createElement(g,{name:"qty",control:a,render:({field:s})=>e.createElement(h,{variant:"standard"},e.createElement(I,{...s,label:r("coupon.list.table.qty"),type:"number",variant:"standard"}))}),l.qty&&e.createElement("p",{className:"text-danger"},l.qty.message)))),e.createElement("div",{className:"card__admin"},e.createElement(q,{variant:"h5",className:"cart_admin_title",gutterBottom:!0},"Setting"),e.createElement(d,{container:!0,sx:{margin:0,padding:1,width:"100%"},spacing:10},e.createElement(d,{item:!0,xs:6},e.createElement("div",{className:"d-inline"},e.createElement(g,{name:"status",control:a,render:({field:s})=>e.createElement(h,null,e.createElement(Y,{id:"status"},"Status",e.createElement("span",{className:"required"})),e.createElement(se,{defaultValue:"1",...s,checked:"1"},e.createElement(L,{value:"1",control:e.createElement(V,null),label:"Active"}),e.createElement(L,{value:"0",control:e.createElement(V,null),label:"Block"})))}))))),e.createElement("div",{className:"d-flex justify-content-center w-100"},e.createElement(T,{variant:"contained",type:"submit",className:"m-1",disabled:E},E&&e.createElement($,{disableShrink:!0,style:{color:"white",width:"14px",height:"14px",margin:"0 5px 0 0"}}),"Update"),e.createElement(T,{variant:"contained",type:"reset",className:"m-1 btn-cancel",onClick:()=>S()},"Clear"))),p&&e.createElement(z,{type:b.type,message:b.message,setShowNoti:C}))},ge=()=>{const y=J(),[x,_]=u.exports.useState(!1),[N,a]=u.exports.useState({}),[S,o]=u.exports.useState(!1),[t,l]=u.exports.useState(),{state:E}=X(),[p]=D(),b=()=>y(-1),C=Z().shape({coupon_code:f().required(p("validate.required",{name:"Coupon code"})),date_start:f().required(p("validate.required",{name:"Date start"})),value:f().required(p("validate.required",{name:"Price discount"})),qty:f().required(p("validate.required",{name:"Qty"})),status:f().required(p("validate.required",{name:"Status"}))}),r=u.exports.useCallback(()=>{w.get(A.SHOW,{params:{id:E.id}}).then(m=>{m.data.code===v.HTTP_OK?l(m.data.coupon):m.data.code===v.HTTP_NOT_FOUND?(a({type:"error",message:m.data.message}),o(!0)):(a({type:"error",message:"Error!"}),o(!0))}).catch(({response:m})=>{a({type:"error",message:m.data?m.data.message:"Server error"}),o(!0)})},[E]);u.exports.useEffect(()=>{r()},[E]);const{handleSubmit:s,control:n,reset:j,setValue:i,getValues:M,setError:G,formState:{errors:K}}=ee({shouldUnregister:!1,defaultValues:{coupon_code:"",date_start:"",date_finish:"",value:"",qty:"",status:te.ACTIVE},resolver:ae(C)}),Q=u.exports.useCallback(m=>{_(!0),w.put(A.UPDATE,{...m}).then(c=>{c.data.code===v.HTTP_OK&&a({type:"success",message:c.data.message}),c.data.code===v.HTTP_NOT_FOUND&&a({type:"error",message:c.data.message}),o(!0),_(!1),setTimeout(()=>{y(-1)},1500)}).catch(({response:c})=>{c.data.code===v.UNPROCESSABLE_ENTITY&&Object.keys(c.data.errors).forEach(F=>{G(F,{type:"custom",message:Object.values(c.data.errors[F])})}),a({type:"error",message:c.data?c.data.message:"Server error"}),o(!0),_(!1)})},[]);return u.exports.useEffect(()=>{i("id",t?t.id:""),i("coupon_code",t&&t.coupon_code?t.coupon_code:""),i("date_start",t&&t.date_start?H(R(t.date_start),"yyyy-MM-dd"):""),i("date_finish",t&&t.date_finish?H(R(t.date_finish),"yyyy-MM-dd"):""),i("status",t?t.status:-1),i("value",t&&t.value?t.value:""),i("qty",t&&t.qty?t.qty:"")},[t]),e.createElement(ne,{redirectBack:b,handleUpdate:Q,handleSubmit:s,control:n,reset:j,setValue:i,getValues:M,errors:K,loading:x,showNoti:S,status:N,setShowNoti:o})};export{ge as default};
