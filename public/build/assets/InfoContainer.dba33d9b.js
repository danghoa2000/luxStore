import{R as e,bt as P,T as O,bj as k,G as f,C as E,F as b,B as A,i as B,S as I,b as w,r as o,a7 as F,au as U,av as L,u as z,d as N,bs as D,q as _,aA as H,aw as R}from"./index.5ce80200.js";import{T as y}from"./TextField.f7bb6de6.js";import"./Select.fa04d544.js";import"./OutlinedInput.63c5b1ce.js";const j=({control:r,setValue:c,account:l,handleSubmit:p,loading:a,handleUpdate:x,status:h,showNoti:d,setShowNoti:v})=>{var i,g;return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex align-items-center profile__bar__item-active",style:{marginBottom:20}},e.createElement(P,null),e.createElement(O,{variant:"h6",margin:"0",style:{fontWeight:"bold"}},"Profile")),e.createElement("section",{style:{background:"#fff",padding:"27px"}},e.createElement("div",{style:{}},e.createElement(k,{sx:{width:50,height:50}},(i=l==null?void 0:l.info)!=null&&i.full_name?(g=l==null?void 0:l.info)==null?void 0:g.full_name.split("")[0]:"")),e.createElement("form",{onSubmit:p(x)},e.createElement(f,{container:!0,sx:{margin:0,padding:1,width:"100%"},spacing:2},e.createElement(f,{item:!0,xs:6,className:"pl-0"},e.createElement(E,{name:"full_name",control:r,render:({field:s})=>e.createElement(b,{variant:"standard"},e.createElement(y,{...s,label:"Full name",size:"small",InputLabelProps:{shrink:!0},onBlur:t=>{c("full_name",t.target.value?t.target.value.trim():"")},className:"light__mode"}))})),e.createElement(f,{item:!0,xs:6},e.createElement(E,{name:"email",control:r,render:({field:s})=>e.createElement(b,{variant:"standard"},e.createElement(y,{...s,label:"Email",size:"small",InputLabelProps:{shrink:!0},onBlur:t=>{c("full_name",t.target.value?t.target.value.trim():"")},className:"light__mode"}))})),e.createElement(f,{item:!0,xs:6,className:"pl-0"},e.createElement(E,{name:"telephone",control:r,render:({field:s})=>e.createElement(b,{variant:"standard"},e.createElement(y,{...s,label:"Telephone",size:"small",InputLabelProps:{shrink:!0},onBlur:t=>{c("telephone",t.target.value?t.target.value.trim():"")},className:"light__mode"}))})),e.createElement(f,{item:!0,xs:6},e.createElement(E,{name:"birthday",control:r,render:({field:s})=>e.createElement(b,{variant:"standard"},e.createElement(y,{...s,label:"Birthday",size:"small",InputLabelProps:{shrink:!0},onBlur:t=>{c("telephone",t.target.value?t.target.value.trim():"")},type:"date",className:"light__mode"}))}))),e.createElement(A,{type:"submit",variant:"contained",className:"btn__checkcout",disabled:a,style:{marginLeft:"0"}},a&&e.createElement(B,{disableShrink:!0,style:{color:"white",width:"14px",height:"14px",margin:"0 5px 0 0"}}),"Update"))),d&&e.createElement(I,{type:h.type,message:h.message,setShowNoti:v}))},$=()=>{const{user:r}=w(),[c,l]=o.exports.useState(!1),[p]=F(),[a,x]=o.exports.useState(),[h,d]=o.exports.useState({}),[v,i]=o.exports.useState(!1),g=U().shape({email:L().required(p("validate.required",{name:"Email"})).email(p("validate.email",{name:"Email"}))}),{handleSubmit:s,control:t,reset:q,setValue:u,getValues:G}=z({defaultValues:{full_name:"",email:"",telephone:"",birthday:"",isCustomer:!0},resolver:R(g)}),T=o.exports.useCallback(()=>{N.post(D.SHOW,{params:{id:r==null?void 0:r.id}}).then(m=>{x(m.data.account),m.data.code===_.HTTP_NOT_FOUND&&(d({type:"error",message:m.data.message}),i(!0))}).catch(({response:m})=>{d({type:"error",message:m.data?m.data.message:"Server error"}),i(!0)})},[r]),C=o.exports.useCallback(m=>{l(!0),N.put(H.UPDATE,{...m}).then(n=>{i(!0),l(!1),n.data.code===_.HTTP_OK&&(d({type:"success",message:n.data.message}),T()),n.data.code===_.HTTP_NOT_FOUND&&d({type:"error",message:n.data.message})}).catch(({response:n})=>{i(!0),l(!1),n.data.code===_.UNPROCESSABLE_ENTITY&&Object.keys(n.data.errors).forEach(S=>{setError(S,{type:"custom",message:Object.values(n.data.errors[S])})}),d({type:"error",message:n.data.message})})},[]);return o.exports.useEffect(()=>{T()},[r]),o.exports.useEffect(()=>{a&&(u("id",a?a.id:""),u("full_name",a&&a.info&&a.info.full_name?a.info.full_name:""),u("email",a&&a.info&&a.info.email?a.info.email:""),u("telephone",a&&a.info&&a.info.telephone?a.info.telephone:""),u("birthday",a&&a.info&&a.info.birthday?a.info.birthday:""))},[a]),e.createElement(j,{control:t,setValue:u,user:r,handleSubmit:s,loading:c,account:a,handleUpdate:C,status:h,showNoti:v,setShowNoti:i})};export{$ as default};
