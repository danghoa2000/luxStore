import{a7 as w,R as e,T as a,G as g,C as M,F as I,h as N,aZ as l,B as L,i as B,r as d,c as D,aa as k,aj as A,a$ as F,o as x,aS as G,S as H,ay as V,u as R,d as P,a_ as U,q as b}from"./index.5ce80200.js";import{O as j}from"./OrderStatus.5d0e6fa3.js";import{S as z}from"./Select.fa04d544.js";import{B as Y}from"./Breadcrumbs.f5b119d2.js";import{f as W}from"./index.d7c082dd.js";import{p as $}from"./index.ac026f14.js";import{E as q}from"./Edit.ce0e6a68.js";import"./index.834d2615.js";import"./RateReview.2cdcdcbe.js";import"./Stack.5c2058c0.js";import"./LocalShipping.a6bfb39a.js";import"./OutlinedInput.63c5b1ce.js";const K=({handleUpdate:u,handleSubmit:h,control:E,loading:i})=>{const[t]=w();return e.createElement(e.Fragment,null,e.createElement(a,{id:"modal-modal-title",variant:"h6",component:"h2",textAlign:"center",color:"#fff"},"Update order progress"),e.createElement(g,{container:!0,sx:{margin:0,padding:1,width:"100%"},spacing:10},e.createElement(g,{item:!0,xs:12},e.createElement(M,{name:"order_status",control:E,render:({field:n})=>e.createElement(I,{variant:"standard"},e.createElement(z,{...n,label:"Order status",size:"small"},e.createElement(N,{key:l.PENDING,value:l.PENDING},t(`order.status.${l.PENDING}`)),e.createElement(N,{key:l.DELEVERY,value:l.DELEVERY},t(`order.status.${l.DELEVERY}`)),e.createElement(N,{key:l.SUCCESS,value:l.SUCCESS},t(`order.status.${l.SUCCESS}`)),e.createElement(N,{key:l.CANCEL,value:l.CANCEL},t(`order.status.${l.CANCEL}`))))})),e.createElement(L,{variant:"contained",className:"m-1",style:{textTransform:"none",maxWidth:"100%"},onClick:h(u)},i&&e.createElement(B,{disableShrink:!0,style:{color:"white",width:"14px",height:"14px",margin:"0 5px 0 0"}}),"Update")))},J=({loading:u,showNoti:h,status:E,setShowNoti:i,order:t,state:n,handleSubmit:o,handleUpdate:v,control:S,open:_,setOpen:p})=>{const c=d.exports.useMemo(()=>t!=null&&t.address?JSON.parse(t==null?void 0:t.address):{},[t]),[C]=w(),T=D();return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex justify-content-between align-items-center"},e.createElement(a,{variant:"h4",gutterBottom:!0},"Orders"),e.createElement(Y,{separator:"\u203A","aria-label":"breadcrumb"},e.createElement(k,{to:"/admin"},"Home"),e.createElement(k,{to:"/admin/orders"},"Order"),e.createElement(a,null,"Detail"),e.createElement(a,null,n==null?void 0:n.id))),e.createElement("div",{className:"card__admin"},e.createElement(j,{order:t})),e.createElement(L,{variant:"contained",color:"info",onClick:()=>T(-1),style:{textTransform:"none",margin:"10px 0"}},"Back"),e.createElement("div",{className:"card__admin",style:{boxShadow:"none"}},e.createElement("div",{className:"order__header"},e.createElement("div",{className:"order__id"},`Order ID: ${t==null?void 0:t.id}`),e.createElement("div",{className:"order__placed"},`Placed on: ${t!=null&&t.created_at?W($(t==null?void 0:t.created_at),"dd MMM, yyyy"):""}`),e.createElement("div",{className:"order__finish"},`Delivered on: ${t!=null&&t.updated_at?W($(t==null?void 0:t.updated_at),"dd MMM, yyyy"):""}`),e.createElement("div",{className:"order__tool"},e.createElement(A,{"aria-label":"edit",size:"small",onClick:()=>(t==null?void 0:t.status)==3?{}:p(!0)},e.createElement(q,{fontSize:"inherit"})))),e.createElement("div",{className:"order__product",style:{marginTop:50}},(t==null?void 0:t.order_detail)&&(t==null?void 0:t.order_detail.map(s=>{var O,y,f;return e.createElement("div",{className:"order__product__item",key:s.id},e.createElement("div",{style:{display:"flex",alignItems:"center",flex:1}},e.createElement("img",{src:F+(s==null?void 0:s.product.image),style:{maxWidth:125},alt:""}),e.createElement("div",{className:"order__product__item-name"},e.createElement(a,{variant:"h6"},(O=s==null?void 0:s.pivot)==null?void 0:O.product_name),e.createElement("p",{style:{color:"rgb(125, 135, 156)",fontSize:14,margin:0}},`${x((y=s==null?void 0:s.pivot)==null?void 0:y.product_price)} x ${(f=s==null?void 0:s.pivot)==null?void 0:f.qty}`))),e.createElement("div",{className:"order__product__item-properties"},`Product properties: ${(s==null?void 0:s.property_value)&&Object.values(s.property_value).map(r=>r.attribute_value_name+", ")}`),e.createElement("div",{className:"order__product__item-properties"}))})))),e.createElement(g,{container:!0,sx:{margin:0,padding:0,width:"100%"},spacing:10},e.createElement(g,{item:!0,xs:6,style:{padding:"0 10px 0 0"}},e.createElement("div",{className:"card__admin"},e.createElement(a,{variant:"h7",className:"color-title",style:{fontWeight:"bold"}},"Shipping Address"),e.createElement("div",{className:"address"},e.createElement("div",{style:{flexGrow:1,flexShrink:1}},e.createElement("div",{className:"address__contact"},e.createElement(a,{variant:"h8"},c==null?void 0:c.full_name),e.createElement("span",{style:{borderLeft:"1px solid rgba(0,0,0,.26)",margin:"0 8px"}}),e.createElement(a,{variant:"h8"},c==null?void 0:c.telephone)),e.createElement(a,{variant:"h8"},c==null?void 0:c.address))),e.createElement(a,{variant:"h7",className:"color-title",style:{fontWeight:"bold",marginTop:10}},"Payment method"),e.createElement(a,{variant:"h8"},C(`payment_method.${(t==null?void 0:t.payment_method)||1}`)),e.createElement(a,{variant:"h7",className:"color-title",style:{fontWeight:"bold",marginTop:10}},"Note"),e.createElement(a,{variant:"h8"},(t==null?void 0:t.note)||"Null"))),e.createElement(g,{item:!0,xs:6,style:{padding:"0 0 0 10px"}},e.createElement("div",{className:"card__admin"},e.createElement(a,{className:"color-title",variant:"h6",style:{fontWeight:"bold"}},"Total Summary"),e.createElement("div",{className:"cart-total product"},e.createElement("div",{className:"cart-total__box"},e.createElement("div",{className:"box__price"},e.createElement(a,{variant:"h7",className:"box__price__label"},"Subtotal:"),e.createElement(a,{variant:"h7",style:{fontWeight:"bold"}},x(((t==null?void 0:t.price)||0)+((t==null?void 0:t.price_discount)||0)))),e.createElement("div",{className:"box__price"},e.createElement(a,{variant:"h7",className:"box__price__label"},"Shipping:"),e.createElement(a,{variant:"h7",style:{fontWeight:"bold"}},"-")),e.createElement("div",{className:"box__price"},e.createElement(a,{variant:"h7",className:"box__price__label"},"Tax:"),e.createElement(a,{variant:"h7",style:{fontWeight:"bold"}},"-")),e.createElement("div",{className:"box__price"},e.createElement(a,{variant:"h7",className:"box__price__label"},"Discount:"),e.createElement(a,{variant:"h7",style:{fontWeight:"bold"}},x((t==null?void 0:t.price_discount)||0)))),e.createElement("h3",{style:{textAlign:"right",fontWeight:"bold"}}," ",x((t==null?void 0:t.price)||0)))))),_&&e.createElement(G,{open:_,handleClose:()=>p(!1)},e.createElement(K,{handleUpdate:v,handleSubmit:o,control:S,loading:u})),h&&e.createElement(H,{type:E.type,message:E.message,setShowNoti:i}))},me=()=>{const[u,h]=d.exports.useState(!1),[E,i]=d.exports.useState({}),[t,n]=d.exports.useState(!1),[o,v]=d.exports.useState(),[S,_]=d.exports.useState(!1),{state:p}=V(),{handleSubmit:c,control:C,reset:T,setValue:s,getValues:O}=R({defaultValues:{id:p.id,order_status:0}}),y=d.exports.useCallback(()=>{P.get(U.SHOW,{params:{id:p.id}}).then(r=>{r.data.code===b.HTTP_OK&&v(r.data.order),r.data.code===b.HTTP_NOT_FOUND&&(i({type:"error",message:r.data.message}),n(!0))}).catch(({response:r})=>{i({type:"error",message:r.data?r.data.message:"Server error"}),n(!0)})},[]),f=r=>{P.put(U.UPDATE,{...r}).then(m=>{n(!0),m.data.code===b.HTTP_OK?(i({type:"success",message:m.data.message}),v(m.data.order)):m.data.code===b.HTTP_NOT_FOUND?i({type:"error",message:m.data.message}):i({type:"warning",message:m.data?m.data.message:"Update error"}),_(!1)}).catch(({response:m})=>{i({type:"error",message:m.data?m.data.message:"Server error"}),n(!0),_(!1)})};return d.exports.useEffect(()=>{y()},[p]),d.exports.useEffect(()=>{o&&Object.keys(o).length>0&&s("order_status",(o==null?void 0:o.status)||0)},[o]),e.createElement(J,{loading:u,showNoti:t,status:E,setShowNoti:n,order:o,state:p,handleSubmit:c,handleUpdate:f,control:C,open:S,setOpen:_})};export{me as default};
