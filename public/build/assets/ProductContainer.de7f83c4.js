import{a7 as se,r as d,u as ce,R as e,G as b,C as P,F as S,h as y,a8 as z,a9 as C,B as K,c as Q,T as J,aa as ne,ab as ie,aB as oe,ac as me,S as le,o as U,d as I,aF as W,q as R,ae as de,aC as ue,ad as pe}from"./index.5ce80200.js";import{T as ge,a as Ee,E as ye,b as be,c as _e,d as j,e as fe}from"./EnhancedTableHead.4e137c38.js";import{P as xe,R as Pe}from"./pathUrl.54e42181.js";import{T as G}from"./TextField.f7bb6de6.js";import{S as w}from"./Select.fa04d544.js";import{B as Se}from"./Breadcrumbs.f5b119d2.js";import{S as Te}from"./Search.7dacac20.js";import{A as ke}from"./AddCircleSharp.04bafc2d.js";import{C as he,R as Le}from"./ReportProblem.91ad1bc7.js";import{B as Oe}from"./BorderColor.6ee4679d.js";import"./KeyboardArrowRight.e41f0be0.js";import"./LastPage.e4998160.js";import"./OutlinedInput.63c5b1ce.js";const Re=t=>{const{headCells:a,setSearchFiled:M,groupCategoryList:h,categoryList:g,manufacturerList:N,showNoti:_,status:q,setStatus:f,setShowNoti:L}=t,[l]=se(),p=d.exports.useMemo(()=>{let n={};return Object.keys(a).forEach(r=>{a[r].inputMode&&a[r].inputMode==="select"?n[r]=-1:n[r]=""}),n},[]),{handleSubmit:A,control:o,reset:O,setValue:u,getValues:T}=ce({defaultValues:{...p,price_min:"",price_max:""}}),B=d.exports.useMemo(()=>{const n=[];return Object.keys(a).forEach((r,E)=>{a[r].id!=="province_id"&&a[r].id!=="district_id"&&a[r].id!=="commune_id"&&a[r].id!=="image"&&a[r].id!=="description"&&a[r].id!=="qty"&&a[r].id!=="sold_qty"&&a[r].id!=="status"&&(a[r].type==="date"?n.push(e.createElement(b,{item:!0,xs:4,key:E},e.createElement(P,{name:a[r].id,control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(G,{...m,label:l(a[r].label),type:"date",size:"small",InputLabelProps:{shrink:!0},onBlur:s=>{u(a[r].id,s.target.value?s.target.value.trim():"")}}))}))):a[r].id==="role"?n.push(e.createElement(b,{item:!0,xs:4,key:E},e.createElement(P,{name:a[r].id,control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(w,{...m,label:l(a[r].label),size:"small"},e.createElement(y,{value:-1},"select option"),e.createElement(y,{value:z.EMPLOYEE},l(`role.${z.EMPLOYEE}`)),e.createElement(y,{value:z.MANAGER},l(`role.${z.MANAGER}`))))}))):a[r].id==="status"?n.push(e.createElement(b,{item:!0,xs:4,key:E},e.createElement(P,{name:a[r].id,control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(w,{...m,label:l(a[r].label),size:"small"},e.createElement(y,{key:"",value:-1},"select option"),e.createElement(y,{key:C.ACTIVE,value:C.ACTIVE},l(`status.${C.ACTIVE}`)),e.createElement(y,{key:C.BLOCK,value:C.BLOCK},l(`status.${C.BLOCK}`))))}))):a[r].id==="manufacturer"?n.push(e.createElement(b,{item:!0,xs:4,key:E},e.createElement(P,{name:a[r].id,control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(w,{...m,label:l("category.list.table.manafacturer"),size:"small"},e.createElement(y,{key:"",value:-1},"select manufacturer"),N.length>0&&N.map(s=>e.createElement(y,{key:s.id,value:s.id},s.name))))}))):a[r].id==="price"?n.push(e.createElement(b,{item:!0,xs:4,key:E,style:{display:"flex",alignItems:"center",padding:25}},e.createElement(b,{item:!0,xs:6},e.createElement(P,{name:"price_min",control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(G,{...m,label:"Min price",size:"small",onBlur:s=>{u("price_min",s.target.value?s.target.value.trim():"")},type:"number"}))})),e.createElement("span",{style:{margin:"0 10px"}},"~"),e.createElement(b,{item:!0,xs:6},e.createElement(P,{name:"price_max",control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(G,{...m,label:"Max price",size:"small",onBlur:s=>{u("price_max",s.target.value?s.target.value.trim():"")},type:"number"}))})))):a[r].id==="group_category_id"?n.push(e.createElement(b,{item:!0,xs:4,key:E},e.createElement(P,{name:a[r].id,control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(w,{...m,label:l("category.list.table.group_category_id"),size:"small"},e.createElement(y,{key:"",value:-1},"select group category"),h.length>0&&h.map(s=>e.createElement(y,{key:s.id,value:s.id},s.name))))}))):a[r].id==="category_id"?n.push(e.createElement(b,{item:!0,xs:4,key:E},e.createElement(P,{name:a[r].id,control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(w,{...m,label:l("category.list.table.category_id"),size:"small"},e.createElement(y,{key:"",value:-1},"select category"),g.length>0&&g.map(s=>e.createElement(y,{key:s.id,value:s.id},s.name))))}))):n.push(e.createElement(b,{item:!0,xs:4,key:E},e.createElement(P,{name:a[r].id,control:o,render:({field:m})=>e.createElement(S,{variant:"standard"},e.createElement(G,{...m,label:l(a[r].label),size:"small",onBlur:s=>{u(a[r].id,s.target.value?s.target.value.trim():"")}}))}))))}),n},[h,g]),F=n=>{if(n.price_max&&n.price_min&&n.price_min>n.price_max){f({type:"warning",message:"Price is invalid, Min price must be lower than Max price"}),L(!0);return}M(n),setPage(0)};return e.createElement("div",null,e.createElement("form",{onSubmit:A(F)},e.createElement(b,{container:!0,sx:{margin:0,padding:1,width:"100%"},spacing:10},B,e.createElement("div",{className:"d-flex w-100"},e.createElement(K,{variant:"contained",type:"submit",className:"m-1",style:{background:"#28a745"}},"Search"),e.createElement(K,{variant:"contained",type:"reset",className:"m-1 btn-cancel",onClick:()=>{O(),M({})}},"Clear")))))},Me=t=>{const{open:a,setOpen:M,order:h,orderBy:g,page:N,rowsPerPage:_,handleRequestSort:q,handleChangePage:f,handleChangeRowsPerPage:L,redirectProductCreate:l,headCells:p,productList:A,showNoti:o,status:O,setStatus:u,setShowNoti:T,setPage:B,setSearchFiled:F,totalRecord:n,deleteProduct:r,groupCategoryList:E,categoryList:m,manufacturerList:s}=t,D=Q();return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex justify-content-between align-items-center"},e.createElement(J,{variant:"h4",gutterBottom:!0},"Product"),e.createElement(Se,{separator:"\u203A","aria-label":"breadcrumb"},e.createElement(ne,{to:"/admin"},"Home"),e.createElement(J,null,"Product"))),e.createElement("div",{style:{marginBottom:10}},e.createElement(K,{variant:"contained",onClick:()=>M(!a)},"Filter ",e.createElement(Te,{sx:{marginLeft:1}})),e.createElement(K,{variant:"contained",onClick:()=>l(),sx:{marginLeft:2}},"Create ",e.createElement(ke,{sx:{marginLeft:1}}))),e.createElement(he,{in:a,timeout:"auto",unmountOnExit:!0},e.createElement("div",{className:"card__admin"},e.createElement(Re,{headCells:p,setSearchFiled:F,groupCategoryList:E,categoryList:m,manufacturerList:s,showNoti:o,status:O,setStatus:u,setShowNoti:T,setPage:B}))),e.createElement("div",{className:"card__admin"},e.createElement(ie,{style:{margin:"-25px"}},e.createElement(ge,{sx:{maxHeight:600},className:"table__dark"},e.createElement(Ee,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"medium",stickyHeader:!0,"aria-label":"sticky table"},e.createElement(ye,{order:h,orderBy:g,onRequestSort:q,headCells:p}),e.createElement(be,null,Object.keys(A).length>0?Object.values(A).map((k,V)=>e.createElement(_e,{hover:!0,key:V},e.createElement(j,{component:"td",scope:"row",padding:"normal"},e.createElement(Oe,{color:"primary",className:"action",onClick:()=>{D(xe.UPDATE,{state:{id:k.id}})}}),e.createElement("span",{className:"tool"}),e.createElement(Pe,{color:"error",className:"action",onClick:()=>r(k.id)})),Object.keys(p).map((x,H)=>p[x].id=="image"?e.createElement(j,{component:"td",key:H,scope:"row",style:{padding:10}},e.createElement("img",{src:oe+k[x],alt:"",style:{maxHeight:150,margin:"auto",display:"block"}})):e.createElement(j,{component:"td",key:H,scope:"row",padding:"checkbox"},p[x].render?p[x].convert?me(p[x].render(k)):p[x].render(k):k[x])))):e.createElement(j,{align:"center",colSpan:Object.keys(p).length+1,style:{opacity:.5,height:"100px"}},e.createElement(Le,null)," No data")))),e.createElement(fe,{rowsPerPageOptions:[5,10,25],component:"div",className:"paginate__admin",count:n,rowsPerPage:_,page:N,onPageChange:f,onRowsPerPageChange:L}))),o&&e.createElement(le,{type:O.type,message:O.message,setShowNoti:T}))},Ne={image:{id:"image",numeric:!1,label:"product.list.table.image",type:"text",inputMode:"text"},product_code:{id:"product_code",numeric:!1,label:"product.list.table.product_code",type:"text",inputMode:"text"},status:{id:"status",numeric:!0,label:"product.list.table.status",convert:!0,render:t=>`status.${t.status}`,type:"status",inputMode:"select"},name:{id:"name",numeric:!0,label:"product.list.table.name",inputMode:"text"},price:{id:"price",numeric:!0,label:"product.list.table.price",render:t=>(t==null?void 0:t.min_price)&&(t==null?void 0:t.max_price)&&(t==null?void 0:t.min_price)==(t==null?void 0:t.max_price)?U(t==null?void 0:t.min_price):(t==null?void 0:t.min_price)&&(t==null?void 0:t.max_price)?U(t==null?void 0:t.min_price)+" ~ "+U(t==null?void 0:t.max_price):U(0),inputMode:"text"},qty:{id:"qty",numeric:!0,label:"product.list.table.qty",render:t=>(t==null?void 0:t.product_detail_sum_qty)||"",inputMode:"text"},sold_qty:{id:"sold_qty",numeric:!0,label:"product.list.table.sold_qty",render:t=>(t==null?void 0:t.sold_qty)||0,inputMode:"text"},category_id:{id:"category_id",numeric:!0,label:"product.list.table.category_id",render:t=>t.category?t.category.name:"",inputMode:"select"},group_category_id:{id:"group_category_id",numeric:!0,label:"product.list.table.group_category_id",render:t=>{var a;return((a=t==null?void 0:t.group_category)==null?void 0:a.name)||""},inputMode:"select"},manufacturer:{id:"manufacturer",numeric:!0,label:"product.list.table.manufacturer_id",render:t=>t.manufacturer?t.manufacturer.name:"",inputMode:"select"}},De=()=>{const[t,a]=d.exports.useState([]),[M,h]=e.useState(!0),[g,N]=e.useState("asc"),[_,q]=e.useState("product_code"),[f,L]=e.useState(0),[l,p]=e.useState(5),[A,o]=d.exports.useState({}),[O,u]=d.exports.useState(!1),[T,B]=d.exports.useState({}),[F,n]=d.exports.useState(0),[r,E]=d.exports.useState([]),[m,s]=d.exports.useState([]),[D,k]=d.exports.useState([]),V=Q(),x={...Ne},H=(c,i)=>{N(_===i&&g==="asc"?"desc":"asc"),q(i)},X=(c,i)=>{L(i)},Z=c=>{p(parseInt(c.target.value,10)),L(0)},v=d.exports.useCallback(()=>{V("/admin/product/create")},[]),Y=d.exports.useCallback(()=>{const c={searchField:T,pageSize:l,currentPage:f,currentSort:_,currentDirection:g};I.get(W.LIST,{params:{...c}}).then(i=>{i.data.code===R.HTTP_OK&&(a(i.data.products),n(i.data.total))}).catch(i=>{o({type:"error",message:i.data?i.data.message:"Server error"}),u(!0)})},[g,_,f,l,T]),ee=d.exports.useCallback(()=>{I.get(de.LIST).then(c=>{c.data.code===R.HTTP_OK&&E(c.data.groupCategories)}).catch(c=>{o({type:"error",message:c.data?c.data.message:"Server error"}),u(!0)})},[]),te=d.exports.useCallback(()=>{I.get(ue.LIST).then(c=>{c.data.code===R.HTTP_OK&&k(c.data.manufacturers)}).catch(c=>{o({type:"error",message:c.data?c.data.message:"Server error"}),u(!0)})},[]),ae=d.exports.useCallback(()=>{I.get(pe.LIST).then(c=>{c.data.code===R.HTTP_OK&&s(c.data.categories)}).catch(c=>{o({type:"error",message:c.data?c.data.message:"Server error"}),u(!0)})},[]);d.exports.useEffect(()=>{te(),ee(),ae()},[]),d.exports.useEffect(()=>{Y()},[g,_,f,l,T]);const re=d.exports.useCallback(c=>{I.delete(W.DELETE+"/"+c).then(i=>{i.data.code===R.HTTP_OK&&(o({type:"success",message:i.data.message}),u(!0),Y()),i.data.code===R.HTTP_NOT_FOUND&&(u(!0),o({type:"error",message:i.data.message}))}).catch(({response:i})=>{i.data.code===R.UNPROCESSABLE_ENTITY&&Object.keys(i.data.errors).forEach($=>{setError($,{type:"custom",message:Object.values(i.data.errors[$])})}),o({type:"error",message:i.data?i.data.message:"Server error"}),u(!0)})},[g,_,f,l,T]);return e.createElement(Me,{open:M,setOpen:h,order:g,orderBy:_,page:f,rowsPerPage:l,handleRequestSort:H,handleChangePage:X,handleChangeRowsPerPage:Z,redirectProductCreate:v,headCells:x,productList:t,showNoti:O,status:A,setStatus:o,setShowNoti:u,setPage:L,setSearchFiled:B,totalRecord:F,deleteProduct:re,groupCategoryList:r,categoryList:m,manufacturerList:D})};export{De as default};
