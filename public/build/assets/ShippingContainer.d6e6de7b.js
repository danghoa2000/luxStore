import{Q as W,H as X,o as ae,a7 as Z,r,R as e,C as H,O as $,u as ee,d as w,aB as K,G as A,F as U,h as B,N as re,ar as se,B as J,aT as G,q as N,ac as ne,T as Q,aa as ce,ab as ie,S as le}from"./index.5ce80200.js";import{d as Y,T as oe,a as me,E as de,b as ue,c as pe,e as ge}from"./EnhancedTableHead.4e137c38.js";import{S as q}from"./Select.fa04d544.js";import{B as te}from"./BorderColor.6ee4679d.js";import{A as Ee}from"./AddCircleSharp.04bafc2d.js";import{B as he}from"./Breadcrumbs.f5b119d2.js";import{C as Se,R as fe}from"./ReportProblem.91ad1bc7.js";import"./KeyboardArrowRight.e41f0be0.js";import"./LastPage.e4998160.js";import"./OutlinedInput.63c5b1ce.js";const be=W(X.jsx("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"CheckCircleOutline"),xe=W(X.jsx("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"HighlightOff"),ye={province:{id:"province_id",numeric:!1,label:"shipping.list.table.province",type:"text",render:c=>c.province?c.province.name:"",flagEdit:!1,inputMode:"text"},district:{id:"district_id",numeric:!0,label:"shipping.list.table.district",type:"text",render:c=>c.district?c.district.name:"",flagEdit:!1,inputMode:"text"},commune:{id:"name",numeric:!0,label:"shipping.list.table.commune",type:"text",render:c=>c.commune?c.commune.name:"",flagEdit:!1,inputMode:"text"},price:{id:"telephone",numeric:!0,label:"shipping.list.table.price",type:"text",render:c=>c.price?ae(c.price):"",flagEdit:!0,inputMode:"number"}},ve=({children:c,editting:b,label:x,flagEdit:O,inputNode:l,name:y,control:d})=>{const[h]=Z(),p=r.exports.useMemo(()=>{switch(l){default:return e.createElement(H,{name:y,control:d,render:({field:S})=>e.createElement($,{...S,type:l,placeholder:h("placehoder",{name:h(x)})})})}},[l,d]);return e.createElement(Y,{component:"td",scope:"row",padding:"normal"},b&&O?p:c)},Pe=c=>{const{setShowNoti:b,setStatus:x,getShippingList:O}=c,[l]=Z(),[y,d]=r.exports.useState([]),[h,p]=r.exports.useState([]),[S,n]=r.exports.useState([]),[u,F]=r.exports.useState(-1),[o,R]=r.exports.useState(-1),[v,_]=r.exports.useState(-1),[I,P]=r.exports.useState(!1),{handleSubmit:M,control:m,reset:C,setValue:f,getValues:z,formState:{errors:T}}=ee({defaultValues:{province_id:u,district_id:o,commune_id:v,price:""}}),L=i=>{P(!0),w.post(G.CREATE,{...i}).then(t=>{t.data.code===N.HTTP_OK&&(x({type:"success",message:t.data.message}),C(),O()),b(!0),P(!1)}).catch(({response:t})=>{t.data.code===N.UNPROCESSABLE_ENTITY?Object.keys(t.data.errors).forEach(D=>{setError(D,{type:"custom",message:Object.values(t.data.errors[D])})}):t.data.code===N.HTTP_FOUND?x({type:"warning",message:t.data.message}):x({type:"error",message:t.data?t.data.message:"Server error"}),b(!0),P(!1)})},g=r.exports.useCallback(()=>{w.get(K+"api/get-province").then(i=>d(i.data.provinces)).catch(i=>{setError(!0)})}),a=r.exports.useCallback(()=>{w.get(K+"api/get-district/"+u).then(i=>p(i.data.districts)).catch(i=>{setError(!0)})}),k=r.exports.useCallback(()=>{w.get(K+"api/get-commune/"+o).then(i=>n(i.data.communes)).catch(i=>{setError(!0)})});return r.exports.useEffect(()=>{g()},[]),r.exports.useEffect(()=>{u&&u!=-1&&a()},[u]),r.exports.useEffect(()=>{o&&o!=-1&&k()},[u,o]),e.createElement("div",null,e.createElement("form",{onSubmit:M(L)},e.createElement(A,{container:!0,sx:{margin:0,padding:1,width:"100%"},spacing:10},e.createElement(A,{item:!0,xs:4},e.createElement(H,{name:"province_id",control:m,render:({field:i})=>e.createElement(U,{variant:"standard"},e.createElement(q,{...i,onChange:t=>{f(t.target.name,t.target.value),F(t.target.value)},label:"province",size:"small"},e.createElement(B,{value:-1},"select province"),y.length>0&&y.map(t=>e.createElement(B,{key:t.id,value:t.id},t.name))))})),e.createElement(A,{item:!0,xs:4},e.createElement(H,{name:"district_id",control:m,render:({field:i})=>e.createElement(U,{variant:"standard"},e.createElement(q,{...i,onChange:t=>{f(t.target.name,t.target.value),R(t.target.value)},label:"district_id",size:"small"},e.createElement(B,{value:-1},"select district"),h.length>0&&h.map(t=>e.createElement(B,{key:t.id,value:t.id},t.name))))})),e.createElement(A,{item:!0,xs:4},e.createElement(H,{name:"commune_id",control:m,render:({field:i})=>e.createElement(U,{variant:"standard"},e.createElement(q,{onChange:t=>{f(t.target.name,t.target.value),_(t.target.value)},...i,label:"commune_id",size:"small"},e.createElement(B,{value:-1},"select commune"),S.length>0&&S.map(t=>e.createElement(B,{key:t.id,value:t.id},t.name))))})),e.createElement(A,{item:!0,xs:6},e.createElement(H,{name:"price",control:m,render:({field:i})=>e.createElement(U,{variant:"standard"},e.createElement(re,{htmlFor:"fullName"},l("shipping.list.table.price")),e.createElement($,{...i,startAdornment:e.createElement(se,{position:"start"},e.createElement(te,null)),type:"number",min:"0",step:"any",placeholder:l("placehoder",{name:l("shipping.list.table.price")}),onBlur:t=>{f(t.target.name,t.target.value?t.target.value.trim():"")}}))}),T.price&&e.createElement("p",{className:"text-danger"},T.price.message)),e.createElement("div",{className:"d-flex w-100 align-items-center"},e.createElement(J,{variant:"contained",type:"submit"},"Create ",e.createElement(Ee,{sx:{marginLeft:1}})),e.createElement(J,{variant:"contained",type:"reset",className:"m-1 btn-cancel",onClick:()=>{C(),setSearchFiled({})}},"Clear")))))},Ce=c=>{const{open:b,setOpen:x,order:O,orderBy:l,page:y,rowsPerPage:d,handleRequestSort:h,handleChangePage:p,handleChangeRowsPerPage:S,headCells:n,shippingList:u,showNoti:F,status:o,setShowNoti:R,setStatus:v,setSearchFiled:_,totalRecord:I,handleUpdate:P,getShippingList:M}=c,[m,C]=r.exports.useState(null),f=r.exports.useMemo(()=>({...Object.keys(n).filter(s=>n[s].flagEdit===!0)}),[n]),z=r.exports.useMemo(()=>{let E={};return Object.values(f).forEach(s=>{E[s]=""}),E},[]),{handleSubmit:T,control:L,reset:g,setValue:a,getValues:k,setError:i,formState:{errors:t}}=ee({defaultValues:{...z}});r.exports.useEffect(()=>{if(m){const E=u.find(s=>s.id===m);Object.values(f).forEach(s=>{a(s,E[s]||"")}),a("id",m)}},[m]);const D=r.exports.useMemo(()=>{const E=[{id:"action",numeric:!1,label:"action",type:"text",render:s=>e.createElement(Y,{component:"td",scope:"row",padding:"normal"},m===s.id?e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex align-items-center"},e.createElement(be,{"aria-label":"btn-update",color:"success",onClick:()=>{P(k()),C(null)}}),e.createElement("span",{style:{fontSize:"23px",margin:"0 5px"}},"/"),e.createElement(xe,{"aria-label":"btn-cancel",color:"error",onClick:()=>C(null)}))):e.createElement(te,{color:"primary",className:"action",onClick:()=>C(s.id)}))}];return Object.keys(n).map((s,V)=>E.push({id:s,numeric:!1,render:j=>e.createElement(ve,{key:V,editting:m===j.id,label:n[s].label,flagEdit:n[s].flagEdit,inputMode:n[s].inputMode,name:s,value:j[s],control:L,setValue:a},n[s].render?n[s].convert?ne(n[s].render(j)):n[s].render(j):j[s])})),E},[m]);return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex justify-content-between align-items-center"},e.createElement(Q,{variant:"h4",gutterBottom:!0},"Shipping"),e.createElement(he,{separator:"\u203A","aria-label":"breadcrumb"},e.createElement(ce,{to:"/admin"},"Home"),e.createElement(Q,null,"Shipping"))),e.createElement(Se,{in:b,timeout:"auto",unmountOnExit:!0},e.createElement("div",{className:"card__admin"},e.createElement(Pe,{setShowNoti:R,setStatus:v,getShippingList:M}))),e.createElement("div",{className:"card__admin"},e.createElement(ie,{style:{margin:"-25px"}},e.createElement("form",{onSubmit:T(P)},e.createElement(oe,{sx:{maxHeight:600},className:"table__dark"},e.createElement(me,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"medium",stickyHeader:!0,"aria-label":"sticky table"},e.createElement(de,{order:O,orderBy:l,onRequestSort:h,headCells:n}),e.createElement(ue,null,u.length>0?u.map((E,s)=>e.createElement(pe,{hover:!0,key:s},D.map(V=>V.render(E)))):e.createElement(Y,{align:"center",colSpan:Object.keys(n).length+1,style:{opacity:.5,height:"100px"}},e.createElement(fe,null)," No data")))),e.createElement(ge,{rowsPerPageOptions:[5,10,25],component:"div",className:"paginate__admin",count:I,rowsPerPage:d,page:y,onPageChange:p,onRowsPerPageChange:S})))),F&&e.createElement(le,{type:o.type,message:o.message,setShowNoti:R}))},Le=()=>{const[c,b]=r.exports.useState([]),[x,O]=e.useState(!0),[l,y]=e.useState("asc"),[d,h]=e.useState("shipping_code"),[p,S]=e.useState(0),[n,u]=e.useState(5),[F,o]=r.exports.useState({}),[R,v]=r.exports.useState(!1),[_,I]=r.exports.useState({}),[P,M]=r.exports.useState(0),m={...ye},C=(g,a)=>{y(d===a&&l==="asc"?"desc":"asc"),h(a)},f=(g,a)=>{S(a)},z=g=>{u(parseInt(g.target.value,10)),S(0)},T=r.exports.useCallback(()=>{const g={searchField:_,pageSize:n,currentPage:p,currentSort:d,currentDirection:l};w.get(G.LIST,{params:{...g}}).then(a=>{a.data.code===N.HTTP_OK&&(b(a.data.shippings),M(a.data.total))}).catch(a=>{o({type:"error",message:a.data?a.data.message:"Server error"}),v(!0)})},[l,d,p,n,_]);r.exports.useEffect(()=>{T()},[l,d,p,n,_]);const L=r.exports.useCallback(g=>{w.put(G.UPDATE,{...g}).then(a=>{a.data.code===N.HTTP_OK&&(o({type:"success",message:a.data.message}),T()),a.data.code===N.HTTP_NOT_FOUND&&o({type:"error",message:a.data.message}),v(!0)}).catch(({response:a})=>{a.data.code===N.UNPROCESSABLE_ENTITY&&Object.keys(a.data.errors).forEach(k=>{setError(k,{type:"custom",message:Object.values(a.data.errors[k])})}),o({type:"error",message:a.data?a.data.message:"Server error"}),v(!0)})},[l,d,p,n,_]);return e.createElement(Ce,{open:x,setOpen:O,order:l,orderBy:d,page:p,rowsPerPage:n,handleRequestSort:C,handleChangePage:f,handleChangeRowsPerPage:z,headCells:m,shippingList:c,showNoti:R,status:F,setShowNoti:v,setStatus:o,setSearchFiled:I,totalRecord:P,handleUpdate:L,getShippingList:T})};export{Le as default};
